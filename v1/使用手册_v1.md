# 茶楼管理系统 v1 使用手册（操作员 & 管理员）

适用范围：TeaHouse_Management/v1 版本

注意：
- 打开方式：浏览器直接打开 v1/index_v1.html
- 数据存储：所有数据保存在浏览器的 LocalStorage 中（清理浏览数据或更换设备/浏览器会影响数据）
- 默认管理员账号：用户名 admin，密码 xj123456（如未改动）
- 登录页按 Enter 键等同于点击“登录”

---

## 一、操作员使用手册（Operator）

### 1. 登录
1) 在登录页输入“用户名 / 密码”
2) 点击“登录”或按 Enter
3) 登录成功后，顶部会显示“当前用户”姓名

如未分配账号，请联系管理员添加

---

### 2. 主界面与房间管理
- 点击房间卡片进入“房间管理”页
- 房间状态说明：
  - 空闲：idle（绿色）
  - 使用中：occupied
  - 预留：reserved

在“房间管理”页可进行以下操作：

#### 2.1 开房
- 点击“开房”，系统开始计时
- 计费规则：按“一场时长”和费率计算（由管理员配置）

#### 2.2 预留
- 空闲房间可“预留”
- 使用中房间不可预留

#### 2.3 暂停/继续
- 使用中可“暂停”，暂停期间不计费
- 再次点击“继续”恢复计时

#### 2.4 结账
- 点击“结账”，弹出付款对话框
- 核对费用：
  - 房费：根据时长/场次计费
  - 商品费：购物车汇总
  - 服务费：空调/烤火/过夜费汇总
  - 欠款：仅显示，不计入“应收合计”
- 选择付款方式与金额（现金/微信/支付宝/银行卡）
- 点击“确认结账”完成交易
- 交易会记录到“每日明细”

#### 2.5 取整选项
- 当使用时长接近场次边界时会出现“向上/向下取整”，选择后房费按取整后的场次数计

---

### 3. 商品销售
- “商品购买”：
  - 选择商品 → 输入数量 → 点击“添加”
- 购物车：
  - 显示已选商品，可“删除”条目
- 库存：
  - 添加商品时自动扣减；删除购物车条目会回补库存

---

### 4. 借贷管理
- 借钱：
  - 输入“客户姓名 / 金额”→ 点击“借钱”
  - 同名客户会合并记录
- 还钱：
  - 选择客户 → 输入金额与方式 → 点击“还钱”
  - 还清后自动移除该客户记录
- 欠款总计：
  - 在“房间管理”页显示，不计入“应收合计”

---

### 5. 附加服务（空调 / 烤火）
- 勾选开启服务
- 控制按钮：
  - 暂停 / 继续 / 停止
- 计费：
  - 按小时向上取整计费（费率由管理员配置）
- 过夜费：
  - 每天 0:00 - 8:00 按小时计费（管理员配置费率）

---

### 6. 每日明细报表
- 顶部“每日明细”进入
- 选择“开始日期 / 结束日期 / 操作员” → 点击“生成报表”
- 下载：
  - “下载日期范围表格”：导出所选日期范围 CSV
  - “手动下载昨日报表”：一键导出前一天报表
- 操作员看不到“清空记录”（仅管理员可见）

---

### 7. 退出登录
- 顶部点击“退出登录”

---

## 二、管理员使用手册（Admin）

管理员拥有操作员全部功能，并可进行系统配置与用户管理

### 1. 费率设置（后台管理 → 费率设置）
- 大厅统一费率：
  - 输入费率（元/4小时）→ 点击“更新”
- 包房费率：
  - 对指定包房设置费率；房间“使用中”不可修改
- 计费设置 — 一场时长：
  - 支持 秒/分钟/小时（最大 24 小时）
  - 更新后“当前设置”会显示为“4小时/30分钟/1800秒”等
- 其他费率：
  - 空调/烤火/过夜费率（元/小时），点击“更新”生效
  - 过夜时段固定为 0:00 - 8:00

---

### 2. 商品管理（后台管理 → 商品管理）
- 添加商品：名称/价格/库存 → “添加商品”
- 修改商品：直接编辑价格/库存 → “更新”
- 删除商品：点击“删除”

---

### 3. 用户管理（后台管理 → 用户管理）
- 添加用户：
  - 用户名/密码/真实姓名/角色（operator/admin）→ “添加用户”
- 重置密码：
  - 点击“重置密码”，输入新密码（≥6 位）
- 删除用户：
  - 点击“删除”
  - 注意：系统禁止删除管理员账号 admin

---

### 4. 每日明细报表（管理员额外能力）
- 生成与下载同操作员
- 额外权限：
  - “清空记录”：清除所有交易（不可恢复），谨慎操作！

---

### 5. 自动下载昨日报表
- 页面保持打开状态下，系统每天 8:00 自动触发“昨日报表”下载
- 如未触发，可使用“手动下载昨日报表”

---

## 三、常见问题（FAQ）
- 登录无响应：
  - 确认打开的是 v1/index_v1.html，账号密码无误
- 按钮点击无反应：
  - 强制刷新（Cmd/Ctrl + Shift + R）清缓存样式
  - 仍存在时记录浏览器与窗口尺寸，联系管理员
- 费率/商品更新未生效：
  - 确认点击了“更新”，且包房不在“使用中”
- 数据丢失：
  - 浏览器清理本地数据、切换设备/浏览器会导致数据不同步

---

## 附录：权限差异
- 操作员（operator）：房间管理 / 商品销售 / 报表查看与下载
- 管理员（admin）：以上全部 + 费率设置 / 商品与用户管理 / 清空记录

（完）
